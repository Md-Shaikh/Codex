<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CODEX - Quantum Encryption Protocol</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: linear-gradient(135deg, hsl(0, 0%, 4%) 0%, hsl(0, 0%, 8%) 100%);
            color: hsl(120, 100%, 75%);
            min-height: 100vh;
            position: relative;
        }

        body::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 20% 50%, rgba(0, 255, 0, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 50%, rgba(0, 255, 0, 0.1) 0%, transparent 50%);
            pointer-events: none;
        }

        body::after {
            content: '@md_the_champ â€¢ www.mdshaikh.online';
            position: fixed;
            bottom: 20px;
            right: 20px;
            color: rgba(0, 255, 0, 0.3);
            font-size: 12px;
            z-index: 2;
            pointer-events: none;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 20px;
            position: relative;
            z-index: 1;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .title-row {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 16px;
        }

        .icon {
            width: 32px;
            height: 32px;
            margin: 0 12px;
            filter: drop-shadow(0 0 10px hsl(120, 100%, 50%));
        }

        .title {
            font-size: 2.5rem;
            font-weight: bold;
            text-shadow: 0 0 10px hsl(120, 100%, 50%);
            animation: matrix-flicker 3s infinite, glitch-effect 1s infinite;
            position: relative;
        }

        .title::before,
        .title::after {
            content: 'CODEX';
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
        }

        .title::before {
            animation: glitch-1 1s infinite;
            color: hsl(0, 100%, 50%);
            z-index: -1;
        }

        .title::after {
            animation: glitch-2 1s infinite;
            color: hsl(240, 100%, 50%);
            z-index: -2;
        }

        .subtitle {
            color: hsl(120, 30%, 60%);
            font-size: 1rem;
        }

        .card {
            background: hsl(0, 0%, 6%);
            border: 1px solid hsl(120, 100%, 50%);
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
            border-radius: 8px;
            margin-bottom: 24px;
            padding: 24px;
        }

        .mode-toggle {
            display: flex;
            justify-content: center;
            gap: 16px;
        }

        .btn {
            padding: 12px 24px;
            border: 1px solid hsl(120, 100%, 50%);
            background: transparent;
            color: hsl(120, 100%, 75%);
            cursor: pointer;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-weight: bold;
            text-shadow: 0 0 10px hsl(120, 100%, 50%);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn:hover {
            background: hsl(120, 100%, 25%);
            box-shadow: 0 0 15px rgba(0, 255, 0, 0.5);
        }

        .btn.active {
            background: hsl(120, 100%, 50%);
            color: hsl(0, 0%, 0%);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .input-section h2,
        .output-section h2 {
            font-size: 1.25rem;
            margin-bottom: 16px;
            text-shadow: 0 0 10px hsl(120, 100%, 50%);
        }

        .section-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 16px;
        }

        .button-group {
            display: flex;
            gap: 8px;
        }

        .btn-sm {
            padding: 8px 16px;
            font-size: 0.875rem;
        }

        .textarea {
            width: 100%;
            height: 200px;
            background: hsl(0, 0%, 8%);
            border: 1px solid hsl(120, 100%, 50%);
            color: hsl(120, 100%, 75%);
            padding: 16px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            resize: none;
            box-shadow: 0 0 10px rgba(0, 255, 0, 0.2);
        }

        .textarea:focus {
            outline: none;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.4);
        }

        .textarea::placeholder {
            color: hsl(120, 30%, 60%);
        }

        .output-display {
            width: 100%;
            height: 200px;
            background: hsl(0, 0%, 8%);
            border: 1px solid hsl(120, 100%, 50%);
            color: hsl(120, 100%, 75%);
            padding: 16px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 0.875rem;
            overflow-y: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .overline {
            text-decoration: overline;
            text-decoration-thickness: 2px;
            text-decoration-color: hsl(120, 100%, 50%);
        }

        .file-input {
            display: none;
        }

        .btn-destructive {
            color: hsl(0, 100%, 50%);
            border-color: hsl(0, 100%, 50%);
        }

        .btn-destructive:hover {
            background: hsl(0, 100%, 25%);
        }

        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            background: hsl(0, 0%, 6%);
            border: 1px solid hsl(120, 100%, 50%);
            border-radius: 8px;
            padding: 16px;
            max-width: 400px;
            z-index: 1000;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }

        .toast.show {
            transform: translateX(0);
        }

        .toast-title {
            font-weight: bold;
            margin-bottom: 4px;
        }

        .toast-description {
            font-size: 0.875rem;
            color: hsl(120, 30%, 60%);
        }

        .loading {
            display: none;
            text-align: center;
            padding: 20px;
        }

        .loading.show {
            display: block;
        }

        .loading-bar {
            width: 100%;
            height: 8px;
            background: hsl(0, 0%, 10%);
            border-radius: 4px;
            overflow: hidden;
            margin-top: 8px;
        }

        .loading-progress {
            height: 100%;
            background: hsl(120, 100%, 50%);
            width: 0%;
            animation: loading-animation 2s ease-in-out;
        }

        .login-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, hsl(0, 0%, 4%) 0%, hsl(0, 0%, 8%) 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 1000;
        }

        .login-card {
            background: hsl(0, 0%, 6%);
            border: 1px solid hsl(120, 100%, 50%);
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
            border-radius: 8px;
            padding: 40px;
            max-width: 400px;
            width: 100%;
            text-align: center;
        }

        .password-input {
            width: 100%;
            padding: 16px;
            background: hsl(0, 0%, 8%);
            border: 1px solid hsl(120, 100%, 50%);
            color: hsl(120, 100%, 75%);
            text-align: center;
            font-family: 'Courier New', monospace;
            font-size: 1.125rem;
            letter-spacing: 0.2em;
            border-radius: 4px;
            margin-bottom: 20px;
        }

        .error-message {
            color: hsl(0, 100%, 50%);
            font-size: 0.875rem;
            margin-top: 8px;
        }

        @keyframes matrix-flicker {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }

        @keyframes glitch-1 {
            0%, 100% { transform: translate(0); }
            20% { transform: translate(-2px, 2px); }
            40% { transform: translate(-2px, -2px); }
            60% { transform: translate(2px, 2px); }
            80% { transform: translate(2px, -2px); }
        }

        @keyframes glitch-2 {
            0%, 100% { transform: translate(0); }
            20% { transform: translate(2px, 2px); }
            40% { transform: translate(2px, -2px); }
            60% { transform: translate(-2px, 2px); }
            80% { transform: translate(-2px, -2px); }
        }

        @keyframes loading-animation {
            0% { width: 0%; }
            100% { width: 100%; }
        }

        @media (max-width: 768px) {
            .container {
                padding: 20px 10px;
            }
            
            .title {
                font-size: 2rem;
            }
            
            .mode-toggle {
                flex-direction: column;
                align-items: center;
            }
            
            .button-group {
                flex-wrap: wrap;
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <!-- Login Screen -->
    <div id="loginScreen" class="login-screen">
        <div class="login-card">
            <div class="title-row">
                <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="4,17 10,11 4,5"></polyline>
                    <line x1="12" y1="19" x2="20" y2="19"></line>
                </svg>
                <h1 class="title">CODEX</h1>
                <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M12,22s8-4 8-10V5l-8-3-8,3v7c0,6 8,10 8,10z"></path>
                </svg>
            </div>
            <p class="subtitle">&gt; QUANTUM SECURITY PROTOCOL &lt;</p>
            <br>
            <form id="loginForm">
                <input type="password" id="passwordInput" class="password-input" placeholder="" autocomplete="off">
                <div id="errorMessage" class="error-message"></div>
                <div id="loginLoading" class="loading">
                    <div>DECRYPTING...</div>
                    <div class="loading-bar">
                        <div class="loading-progress"></div>
                    </div>
                </div>
            </form>
        </div>
    </div>

    <!-- Main Application -->
    <div id="mainApp" style="display: none;">
        <div class="container">
            <!-- Header -->
            <div class="header">
                <div class="title-row">
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <polyline points="4,17 10,11 4,5"></polyline>
                        <line x1="12" y1="19" x2="20" y2="19"></line>
                    </svg>
                    <h1 class="title">CODEX</h1>
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M12,22s8-4 8-10V5l-8-3-8,3v7c0,6 8,10 8,10z"></path>
                    </svg>
                </div>
                <p class="subtitle">&gt; QUANTUM ENCRYPTION PROTOCOL ACTIVE md_the_champ &lt;</p>
            </div>

            <!-- Mode Toggle -->
            <div class="card">
                <div class="mode-toggle">
                    <button id="encryptBtn" class="btn active">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <polygon points="13,2 3,14 12,14 11,22 21,10 12,10"></polygon>
                        </svg>
                        ENCRYPT
                    </button>
                    <button id="decryptBtn" class="btn">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <path d="M12,22s8-4 8-10V5l-8-3-8,3v7c0,6 8,10 8,10z"></path>
                        </svg>
                        DECRYPT
                    </button>
                </div>
            </div>

            <!-- Input Section -->
            <div class="card input-section">
                <div class="section-header">
                    <h2 id="inputTitle">&gt; INPUT_DATA</h2>
                    <div class="button-group">
                        <button id="uploadBtn" class="btn btn-sm">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M21,15v4a2,2 0 0,1 -2,2H5a2,2 0 0,1 -2,-2v-4"></path>
                                <polyline points="7,10 12,15 17,10"></polyline>
                                <line x1="12" y1="15" x2="12" y2="3"></line>
                            </svg>
                            UPLOAD
                        </button>
                        <button id="clearBtn" class="btn btn-sm btn-destructive">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <polyline points="3,6 5,6 21,6"></polyline>
                                <path d="M19,6v14a2,2 0 0,1 -2,2H7a2,2 0 0,1 -2,-2V6m3,0V4a2,2 0 0,1 2,-2h4a2,2 0 0,1 2,2v2"></path>
                            </svg>
                            CLEAR
                        </button>
                    </div>
                </div>
                <textarea id="inputText" class="textarea" placeholder="Enter plaintext data or upload a file..."></textarea>
                <input type="file" id="fileInput" class="file-input" accept=".txt">
            </div>

            <!-- Output Section -->
            <div class="card output-section">
                <div class="section-header">
                    <h2 id="outputTitle">&gt; ENCRYPTED_OUTPUT</h2>
                    <div class="button-group">
                        <button id="copyBtn" class="btn btn-sm" disabled>
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <rect x="9" y="9" width="13" height="13" rx="2" ry="2"></rect>
                                <path d="M5,15H4a2,2 0 0,1 -2,-2V4a2,2 0 0,1 2,-2H13a2,2 0 0,1 2,2v1"></path>
                            </svg>
                            COPY
                        </button>
                        <button id="downloadTxtBtn" class="btn btn-sm" disabled>
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14,2H6a2,2 0 0,0 -2,2v16a2,2 0 0,0 2,2h12a2,2 0 0,0 2,-2V8z"></path>
                                <polyline points="14,2 14,8 20,8"></polyline>
                                <line x1="16" y1="13" x2="8" y2="13"></line>
                                <line x1="16" y1="17" x2="8" y2="17"></line>
                                <polyline points="10,9 9,9 8,9"></polyline>
                            </svg>
                            TXT
                        </button>
                        <button id="downloadPdfBtn" class="btn btn-sm" disabled>
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <path d="M14,2H6a2,2 0 0,0 -2,2v16a2,2 0 0,0 2,2h12a2,2 0 0,0 2,-2V8z"></path>
                                <polyline points="14,2 14,8 20,8"></polyline>
                            </svg>
                            PDF
                        </button>
                    </div>
                </div>
                <div id="outputText" class="output-display">Encrypted data will appear here...</div>
            </div>
        </div>
    </div>

    <!-- Toast Container -->
    <div id="toastContainer"></div>

    <script>
        // Cipher mapping
        const CIPHER_MAP = {
            'A': '4', 'B': '6', 'C': '7', 'D': '5', 'E': '8', 'F': '9',
            'G': '10', 'H': '3', 'I': '11', 'J': '13', 'K': '14', 'L': '12',
            'M': '1', 'N': '15', 'O': '16', 'P': '17', 'Q': '18', 'R': '19',
            'S': '20', 'T': '21', 'U': '2', 'V': '22', 'W': '23', 'X': '24',
            'Y': '25', 'Z': '26'
        };

        // Reverse mapping
        const REVERSE_CIPHER_MAP = {};
        Object.keys(CIPHER_MAP).forEach(key => {
            REVERSE_CIPHER_MAP[CIPHER_MAP[key]] = key;
        });

        const MULTI_DIGIT_NUMBERS = ['10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', '23', '24', '25', '26'];

        // Application state
        let currentMode = 'encrypt';
        let isAuthenticated = false;
        let inactivityTimer = null;

        // Generate today's password
        function generateTodaysPassword() {
            const now = new Date();
            const day = String(now.getDate()).padStart(2, '0');
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const year = now.getFullYear();
            return `11DeC@2006${day}/${month}/${year}`;
        }

        // Text to cipher conversion
        function textToCipher(text) {
            if (!text.trim()) return '';
            
            const words = text.split(/(\s+)/);
            const convertedWords = [];
            
            for (const word of words) {
                if (/^\s+$/.test(word)) {
                    convertedWords.push(word);
                    continue;
                }
                
                const parts = word.match(/([a-zA-Z]+)|(\d+)|([^a-zA-Z0-9])/g) || [];
                const convertedParts = [];
                
                for (const part of parts) {
                    if (/^[a-zA-Z]+$/.test(part)) {
                        const cipherCodes = [];
                        for (const char of part.toUpperCase()) {
                            if (CIPHER_MAP[char]) {
                                const code = CIPHER_MAP[char];
                                if (MULTI_DIGIT_NUMBERS.includes(code)) {
                                    cipherCodes.push(`[${code}]`);
                                } else {
                                    cipherCodes.push(code);
                                }
                            }
                        }
                        convertedParts.push(`overline:^^${cipherCodes.join(' ')}^^:endoverline`);
                    } else if (/^\d+$/.test(part)) {
                        const num = parseInt(part);
                        if (num >= 10) {
                            convertedParts.push(`{${part}}`);
                        } else {
                            convertedParts.push(part);
                        }
                    } else {
                        convertedParts.push(part);
                    }
                }
                
                convertedWords.push(convertedParts.join(''));
            }
            
            return convertedWords.join('');
        }

        // Cipher to text conversion
        function cipherToText(cipher) {
            if (!cipher.trim()) return '';
            
            let cleanCipher = cipher.replace(/overline:/g, '').replace(/:endoverline/g, '');
            const lines = cleanCipher.split(/\n/);
            const allConvertedParts = [];
            
            for (const line of lines) {
                if (line.trim() === '') {
                    allConvertedParts.push('');
                    continue;
                }
                
                const parts = line.split(/\^\^/);
                const convertedParts = [];
                
                for (let i = 0; i < parts.length; i++) {
                    const part = parts[i];
                    
                    if (part.trim() === '') {
                        continue;
                    }
                    
                    const matches = part.match(/(\[\d+\])|(\{\d+\})|(\d+)|([^0-9\[\]{}])/g) || [];
                    let convertedText = '';
                    
                    for (const match of matches) {
                        if (/^\[\d+\]$/.test(match)) {
                            const cleanCode = match.replace(/\[|\]/g, '');
                            if (REVERSE_CIPHER_MAP[cleanCode]) {
                                convertedText += REVERSE_CIPHER_MAP[cleanCode];
                            }
                        } else if (/^\{\d+\}$/.test(match)) {
                            const realNumber = match.replace(/\{|\}/g, '');
                            convertedText += realNumber;
                        } else if (/^\d+$/.test(match)) {
                            if (REVERSE_CIPHER_MAP[match]) {
                                convertedText += REVERSE_CIPHER_MAP[match];
                            } else {
                                convertedText += match;
                            }
                        } else if (match.trim() !== '') {
                            convertedText += match;
                        }
                    }
                    
                    if (convertedText.trim() !== '') {
                        convertedParts.push(convertedText.trim());
                    }
                }
                
                if (convertedParts.length > 0) {
                    allConvertedParts.push(convertedParts.join(' '));
                }
            }
            
            return allConvertedParts.join('\n');
        }

        // Format cipher for display
        function formatCipherForDisplay(cipher) {
            return cipher.replace(/overline:/g, '').replace(/:endoverline/g, '');
        }

        // Render output with overlines
        function renderOutputWithOverlines(text) {
            if (!text.includes('overline:')) {
                return text;
            }
            
            let html = text;
            html = html.replace(/overline:([^]*?)(?=:endoverline|$)/g, '<span class="overline">$1</span>');
            html = html.replace(/:endoverline/g, '');
            
            return html;
        }

        // Show toast notification
        function showToast(title, description, duration = 3000) {
            const toastContainer = document.getElementById('toastContainer');
            const toast = document.createElement('div');
            toast.className = 'toast';
            toast.innerHTML = `
                <div class="toast-title">${title}</div>
                <div class="toast-description">${description}</div>
            `;
            
            toastContainer.appendChild(toast);
            
            // Trigger animation
            setTimeout(() => toast.classList.add('show'), 100);
            
            // Remove toast
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toastContainer.removeChild(toast), 300);
            }, duration);
        }

        // Login functionality
        function handleLogin() {
            const password = document.getElementById('passwordInput').value;
            const errorMessage = document.getElementById('errorMessage');
            const loginLoading = document.getElementById('loginLoading');
            
            if (!password) return;
            
            loginLoading.classList.add('show');
            errorMessage.textContent = '';
            
            const expectedPassword = generateTodaysPassword();
            
            setTimeout(() => {
                loginLoading.classList.remove('show');
                
                if (password === expectedPassword) {
                    isAuthenticated = true;
                    document.getElementById('loginScreen').style.display = 'none';
                    document.getElementById('mainApp').style.display = 'block';
                    startInactivityTimer();
                } else {
                    errorMessage.textContent = 'ACCESS DENIED';
                    document.getElementById('passwordInput').value = '';
                }
            }, 2000);
        }

        // Convert text based on current mode
        function convertText() {
            const inputText = document.getElementById('inputText').value;
            const outputElement = document.getElementById('outputText');
            
            if (!inputText.trim()) {
                outputElement.innerHTML = currentMode === 'encrypt' ? 
                    'Encrypted data will appear here...' : 
                    'Decrypted data will appear here...';
                updateButtonStates(false);
                return;
            }
            
            let result;
            if (currentMode === 'encrypt') {
                result = textToCipher(inputText);
                outputElement.innerHTML = renderOutputWithOverlines(result);
            } else {
                result = cipherToText(inputText);
                outputElement.textContent = result;
            }
            
            updateButtonStates(true);
        }

        // Update button states
        function updateButtonStates(hasOutput) {
            document.getElementById('copyBtn').disabled = !hasOutput;
            document.getElementById('downloadTxtBtn').disabled = !hasOutput;
            document.getElementById('downloadPdfBtn').disabled = !hasOutput;
        }

        // Toggle mode
        function toggleMode(mode) {
            currentMode = mode;
            
            const encryptBtn = document.getElementById('encryptBtn');
            const decryptBtn = document.getElementById('decryptBtn');
            const inputTitle = document.getElementById('inputTitle');
            const outputTitle = document.getElementById('outputTitle');
            const inputText = document.getElementById('inputText');
            
            if (mode === 'encrypt') {
                encryptBtn.classList.add('active');
                decryptBtn.classList.remove('active');
                inputTitle.textContent = '> INPUT_DATA';
                outputTitle.textContent = '> ENCRYPTED_OUTPUT';
                inputText.placeholder = 'Enter plaintext data or upload a file...';
            } else {
                encryptBtn.classList.remove('active');
                decryptBtn.classList.add('active');
                inputTitle.textContent = '> CIPHER_DATA';
                outputTitle.textContent = '> DECRYPTED_OUTPUT';
                inputText.placeholder = 'Enter encrypted data or upload a file...';
            }
            
            // Clear inputs and convert
            document.getElementById('inputText').value = '';
            convertText();
        }

        // Copy to clipboard
        async function copyToClipboard() {
            const outputElement = document.getElementById('outputText');
            const text = currentMode === 'encrypt' ? 
                formatCipherForDisplay(outputElement.textContent || outputElement.innerText) :
                outputElement.textContent;
            
            try {
                await navigator.clipboard.writeText(text);
                showToast("Copied to clipboard!", "The converted code has been copied successfully.");
            } catch (err) {
                showToast("Copy failed", "Unable to copy to clipboard. Please try again.", 5000);
            }
        }

        // Download as text file
        function downloadAsText() {
            const outputElement = document.getElementById('outputText');
            const text = currentMode === 'encrypt' ? 
                formatCipherForDisplay(outputElement.textContent || outputElement.innerText) :
                outputElement.textContent;
            
            if (!text || text.includes('will appear here')) return;
            
            // Generate filename with current date/time
            const now = new Date();
            const day = String(now.getDate()).padStart(2, '0');
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const year = now.getFullYear();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const filename = `${day}${month}${year}_${hours}${minutes}_Codex.txt`;
            
            const blob = new Blob([text], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showToast("Download Complete", "File saved successfully!");
        }

        // Convert date/time to cipher format for PDF
        function dateTimeToCipher() {
            const now = new Date();
            const day = now.getDate();
            const month = now.getMonth();
            const year = now.getFullYear();
            const hours = now.getHours();
            const minutes = now.getMinutes();
            
            const ones = ['', 'one', 'two', 'three', 'four', 'five', 'six', 'seven', 'eight', 'nine', 'ten', 'eleven', 'twelve', 'thirteen', 'fourteen', 'fifteen', 'sixteen', 'seventeen', 'eighteen', 'nineteen'];
            const tens = ['', '', 'twenty', 'thirty', 'forty', 'fifty'];
            const months = ['january', 'february', 'march', 'april', 'may', 'june', 'july', 'august', 'september', 'october', 'november', 'december'];
            
            const numberToWords = (num) => {
                if (num < 20) return ones[num];
                if (num < 60) return tens[Math.floor(num / 10)] + (num % 10 ? ' ' + ones[num % 10] : '');
                return num.toString();
            };
            
            const dayWord = numberToWords(day);
            const monthWord = months[month];
            const yearWord = `two thousand ${numberToWords(year - 2000)}`;
            const hourWord = numberToWords(hours === 0 ? 12 : hours > 12 ? hours - 12 : hours);
            const minuteWord = numberToWords(minutes);
            const ampm = hours >= 12 ? 'pm' : 'am';
            
            const dateTimeText = `${dayWord} ${monthWord} ${yearWord} ${hourWord} ${minuteWord} ${ampm}`;
            return textToCipher(dateTimeText);
        }

        // Generate password for PDF
        function generatePassword() {
            const now = new Date();
            const day = String(now.getDate()).padStart(2, '0');
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const year = now.getFullYear();
            return `11DeC@2006${day}/${month}/${year}`;
        }

        // Download as PDF (simplified version without jsPDF dependency)
        function downloadAsPDF() {
            const outputElement = document.getElementById('outputText');
            const text = currentMode === 'encrypt' ? 
                formatCipherForDisplay(outputElement.textContent || outputElement.innerText) :
                outputElement.textContent;
            
            if (!text || text.includes('will appear here')) return;
            
            // Generate password and date/time cipher
            const password = generatePassword();
            const dateTimeCipher = dateTimeToCipher();
            const cleanDateTime = formatCipherForDisplay(dateTimeCipher);
            
            // Create content for PDF
            const finalContent = `${cleanDateTime}\n\n${text}`;
            
            // Generate filename with current date/time
            const now = new Date();
            const day = String(now.getDate()).padStart(2, '0');
            const month = String(now.getMonth() + 1).padStart(2, '0');
            const year = now.getFullYear();
            const hours = String(now.getHours()).padStart(2, '0');
            const minutes = String(now.getMinutes()).padStart(2, '0');
            const filename = `${day}${month}${year}_${hours}${minutes}_Codex.txt`;
            
            // Since we can't create real PDFs without a library, we'll download as text with PDF extension
            const blob = new Blob([finalContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename.replace('.txt', '.pdf');
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            showToast("PDF Download Complete", `File saved as ${filename.replace('.txt', '.pdf')}. Password: ${password}`, 10000);
        }

        // Handle file upload
        function handleFileUpload(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                const content = e.target.result;
                
                // Check if content appears to be encrypted
                const hasSquareBrackets = content.includes('[') && content.includes(']');
                const hasCurlyBraces = content.includes('{') && content.includes('}');
                const hasBoundaryMarkers = content.includes('^^');
                
                if (hasSquareBrackets || hasCurlyBraces || hasBoundaryMarkers) {
                    toggleMode('decrypt');
                    showToast("Encrypted File Detected", "File loaded and switched to decrypt mode");
                } else {
                    toggleMode('encrypt');
                    showToast("Text File Loaded", "File loaded and switched to encrypt mode");
                }
                
                document.getElementById('inputText').value = content;
                convertText();
            };
            reader.readAsText(file);
        }

        // Clear inputs
        function clearInputs() {
            document.getElementById('inputText').value = '';
            convertText();
        }

        // Auto-lock functionality
        function lockApplication() {
            isAuthenticated = false;
            document.getElementById('loginScreen').style.display = 'flex';
            document.getElementById('mainApp').style.display = 'none';
            document.getElementById('passwordInput').value = '';
            document.getElementById('errorMessage').textContent = '';
            if (inactivityTimer) {
                clearTimeout(inactivityTimer);
                inactivityTimer = null;
            }
        }

        function resetInactivityTimer() {
            if (!isAuthenticated) return;
            
            if (inactivityTimer) {
                clearTimeout(inactivityTimer);
            }
            
            inactivityTimer = setTimeout(() => {
                lockApplication();
            }, 300000); // 5 minutes = 300000ms
        }

        function startInactivityTimer() {
            const activityEvents = ['mousedown', 'mousemove', 'keypress', 'scroll', 'touchstart', 'click'];
            
            activityEvents.forEach(event => {
                document.addEventListener(event, resetInactivityTimer, true);
            });
            
            resetInactivityTimer();
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Login form
            document.getElementById('loginForm').addEventListener('submit', function(e) {
                e.preventDefault();
                handleLogin();
            });
            
            document.getElementById('passwordInput').addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    handleLogin();
                }
            });
            
            // Mode toggle buttons
            document.getElementById('encryptBtn').addEventListener('click', () => toggleMode('encrypt'));
            document.getElementById('decryptBtn').addEventListener('click', () => toggleMode('decrypt'));
            
            // Input text area
            document.getElementById('inputText').addEventListener('input', convertText);
            
            // Buttons
            document.getElementById('copyBtn').addEventListener('click', copyToClipboard);
            document.getElementById('downloadTxtBtn').addEventListener('click', downloadAsText);
            document.getElementById('downloadPdfBtn').addEventListener('click', downloadAsPDF);
            document.getElementById('clearBtn').addEventListener('click', clearInputs);
            
            // File upload
            document.getElementById('uploadBtn').addEventListener('click', function() {
                document.getElementById('fileInput').click();
            });
            document.getElementById('fileInput').addEventListener('change', handleFileUpload);
            
            // Initialize
            convertText();
        });
    </script>
</body>
</html>